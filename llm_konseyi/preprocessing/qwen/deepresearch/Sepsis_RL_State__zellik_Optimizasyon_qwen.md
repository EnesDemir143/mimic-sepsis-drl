# Sepsis RL State Özellik Optimizasyon

---

### 我

# RL Sepsis Ajanı: Veri Ön İşleme (Preprocessing) Konsey Değerlendirmesi

**Bağlam:**
Biz tıp alanında, MIMIC-IV veri setini kullanarak Sepsis yönetimi için Derin Pekiştirmeli Öğrenme (Deep Reinforcement Learning - DRL) modelleri geliştirmeyi amaçlayan bir proje yürütüyoruz. Amacımız, yoğun bakım (ICU) ortamındaki sepsis hastalarının verilerini işleyerek klinik durumlarını (state) modellemek ve bu verilere dayanarak optimum tedavi stratejilerini (örn. vazopressör dozajı ve sıvı tedavisi) öğrenecek yapay zeka ajanları (RL agent) eğitmektir.

Veri biliminde performansı artırmak ve RAM taşmasını engellemek amacıyla Polars kütüphanesini kullanarak, zaman serisi tıbbi verileri saatli periyotlara (hourly binning) çeviren, lazy evaluation + single-pass group-by içeren bellek dostu bir süreç kurguladık.

**Görev:**
Sen üst düzey bir veri bilimi ve medikal yapay zeka konseyinin danışman üyesisin. Bu istem (prompt) ile birlikte sana projemizin durumunu anlatan dosyalar ve kodlar sağlıyorum. Lütfen sana ilettiğim şu dökümanları incele:
1. `project_summary.md`: Projenin genel mimarisi, yapısı ve hedefi.
2. `notebooks/01_data_explore.md` & `notebooks/02_feature_engineering.md`: Veri üzerinde yaptığımız keşifsel analiz (EDA), hücre (cell) çıktıları, eksik veri grafikleri, saatlik gruplamalar ve korelasyonların sonuçları.
3. `src/preprocess/config.py` & `src/preprocess/pipeline.py`: Araştırmalarımız sonucunda elde ettiğimiz bulguları, Polars kullanarak devasa MIMIC-IV verilerine (OOM hatası almadan) uyguladığımız production-ready (canlıya hazır) nihai bellek dostu ön işleme hattımız.

***(Önemli Not: Notebook'larda verinin yapısı/çıktıları ve EDA yöntemlerimiz mevcuttur. Python (.py) dosyalarında ise bu kararların tüm veriye nasıl bir teknik mimariyle aktarıldığı bulunur. Lütfen her iki kaynağı da sentezleyerek yorum yap.)***

Lütfen sadece "veri ön işleme", "feature engineering" ve "RL State (durum) / Action (aksiyon) alanı seçimi" kapsamlarına odaklanarak kodlarımızı ve çıktıları analiz et. Bize şu soruların cevabını ve stratejik öneriler sun:

1. **Bu projenin veri ön işlemesinde eksik olan kritik bilgiler, özellikler (feature) nelerdir?** 
   - İlettiğim notebook çıktılarına (eksik veri oranları vs.) ve Python dosyalarındaki logic'e bakarak, RL ajanının "state" (durum) uzayı için eksik ama başarı için elzem olan laboratuvar, vital veya demografik veriler var mı? (Örn: Sepsis-3 teşhis kriterleri eksiksiz karşılanıyor mu? Saatlik SOFA skoru, SIRS kriterleri, antibiyotik kullanım başlama zamanı, mekanik ventilasyon durumu eklenmeli mi?)

2. **Mevcut Verilerden Neler Üretilebilir / Eklenebilir?**
   - Hangi yeni klinik/laboratuvar değişkenler modele önemli bir içgörü katar? EDA verilerine dayanarak RL ajanı için state tanımını güçlendiren ek "feature engineering" tavsiyelerin nelerdir? (Örn: Değişim hızları (delta değerleri), ağırlık üzerinden standardize edilmiş dozlar vs.)

3. **Mevcut geliştirme aşamasında (kodda veya metodolojide) geliştirilebilecek mühendislik / istatistiksel yöntemler nelerdir?**
   - Özellikle Notebook'lardaki hücre sonuçlarını dikkate alıp, `pipeline.py` içindeki işlemleri (imputasyon vs.) birleştirdiğinde, daha efektif bir işleme veya doldurma metodu görüyor musun? (Örn: Biz forward-fill uyguladık. İstatistiksel ve tıbbi olarak, ekstrem null oranına sahip feature'larda daha iyi bir interpolasyon/imputasyon uygulanabilir mi? Outlier handling veya scaling konusunda eksiklerimiz nelerdir?)

Lütfen sadece genel-geçer bilgiler vermek yerine, sana verdiğim kod mimarisini ve notebook çıktı sonuçlarını *(null oranları, dağılımlar vs.)* baz alarak projemize özel net, uygulanabilir teknik ve tıbbi tavsiyeleri **maddeler halinde ve detaylı olarak** açıkla.

---
*(Lütfen cevaplarınızı direkt çözüm stratejilerimiz üzerine odaklayın, yukarıdaki metni veya kod bloklarını gereksiz yere tekrar kopyalamayın.)*

### Qwen

1. Sepsis-3 tanı kriterlerinin eksiksiz karşılanması için saatlik SOFA skoru hesaplamasında kullanılan bileşenlerde (özellikle sofa_resp ve sofa_liver) çok yüksek null oranları mevcut; bu durumda RL ajanının klinik olarak geçerli kararlar alabilmesi için SOFA skorunun güvenilirliğini artırmak adına FiO2 ve PaO2 gibi solunum bileşeni verilerini doldurmak veya alternatif bir ventilasyon göstergesi (örneğin O2 akışı, PEEP seviyesi) entegre etmek gerekir mi?

2. Antibiyotik başlangıç zamanı ve mekanik ventilasyon durumu gibi sepsis yönetimi için kritik olan klinik olaylar şu anki state vektöründe doğrudan yer almıyor; bu bilgiler MIMIC-IV’in prescriptions ve procedureevents tablolarından çıkarılarak saatlik binned veriye ikili (binary) veya süre bazlı özellikler olarak eklenmeli mi?

3. Şu anki forward-fill imputasyon stratejisi, özellikle %80’in üzerinde null oranı olan temp_c gibi değişkenlerde yanıltıcı stabilite izlenimi yaratabilir; tıbbi geçerlilik ve RL öğrenmesinin sağlamlığı açısından, yüksek oranda eksik olan laboratuvar değerleri için (örneğin lactate, bilirubin) multi-step imputasyon (örneğin MICE) veya bu değişkenlerin sadece gözlemlendiği zamanlarda RL state’ine dahil edilmesi gibi koşullu bir yaklaşım mı tercih edilmeli?

### 我

bu 3 soruya da araştırarak en iyi cevabı ver

### Qwen

Got it. Please feel free to provide additional context or redirect my focus at any point during my work—your input is always welcome.

Bu araştırma, yoğun bakım ünitelerinde sepsis tedavisini optimize etmeyi hedefleyen bir Derin Pekiştirmeli Öğrenme projesinin veri hazırlık aşamasını değerlendirmeyi amaçlamaktadır. Odak noktası, MIMIC-IV veri setinden saatlik periyotlara dönüştürülen zaman serisi tıbbi verilerin RL ajanı için yeterli ve klinik olarak geçerli bir 'durum' (state) uzayı oluşturup oluşturmadığıdır. Araştırma özellikle üç boyutta incelenmektedir: (1) Sepsis-3 tanı kriterlerini tam olarak karşılayacak temel klinik göstergelerin (örn. SOFA skoru bileşenleri, antibiyotik başlangıcı, mekanik ventilasyon durumu) veri ön işleme hattına dahil edilip edilmediği; (2) mevcut EDA çıktılarına dayanarak yeni türevsel özelliklerin (örn. değişşim oranları, doz standardizasyonu) modele katma potansiyeli; ve (3) yüksek null oranlarına sahip değişkenlerde uygulanan forward-fill imputasyonunun yerine daha tıbbi ve istatistiksel olarak sağlam alternatiflerin (örn. koşullu dahil etme, çoklu imputasyon) kullanılabilirliği. Araştırma kapsamı yalnızca veri ön işleme, özellik mühendisliği ve RL state/action tanımı ile sınırlıdır; model eğitimi veya değerlendirme metrikleri dışlanmıştır. Zaman kısıtı belirtilmemiş olup, analiz mevcut kodlar (pipeline.py, config.py) ve notebook çıktıları (EDA, eksik veri oranları) üzerinden yürütülecektir.



# Sepsis Yönetimi İçin DRL Modeli: MIMIC-IV Verisinden Klinik Geçerliliğe ve İstatistiksel Sağlıklı Bir Durum Uzayı Oluşturmaya Yol Haritası

## Klinik Geçerlilik ve Durum Alanı: Sepsis-3 Tanımlarına Uyum Değerlendirmesi

Bu bölümde, MIMIC-IV veri seti üzerinde geliştirilen Derin Pekiştirmeli Öğrenme (DRL) sepsis ajanının temelini oluşturan "durum" (state) uzayının, güncel klinik standartlar olan Sepsis-3 tanı kriterleri ile ne ölçüde uyumlu olduğu incelenmektedir [[40,51]]. Bir RL ajanının yoğun bakım ünitesinde (YBÜ) güvenilir ve etkili tedavi stratejileri geliştirebilmesi, onun gördüğü "durum"un, hastanın gerçek klinik durumunu mümkün olduğunca doğru ve eksiksiz yansıtmak üzerine kurulmasıyla mümkündür. Analiz, projenin mevcut durum alanı tanımında, Sepsis-3 tanısının temelini oluşturan bazı kritik bileşenlerin eksikliğinin veya yanlış temsil edilmesinin potansiyel riskler taşıdığını ortaya koymaktadır. Bu riskler, özellikle organ disfonksiyonunu değerlendiren SOFA skoru, tedavi yanıtı için kullanılan laktat ölçütleri ve hayati öneme sahip klinik eylemlerin izlenmesi gibi alanlarda kendini göstermektedir.

Sepsis-3 tanımına göre, sepsis; enfeksiyonun bir sonucu olarak ortaya çıkan hayati tehlike oluşturabilen organ disfonksiyonudur [[39,40]]. Bu tanı, en az 2 puanlık bir artışı ifade eden Sequential Organ Failure Assessment (SOFA) skoruna dayanır [[26,48]]. Dolayısıyla, SOFA skoru, hem tanıyı konumak hem de hastanın prognozunu değerlendirmek için kullanılan merkezi bir göstergedir [[33,53]]. Ancak, projenin mevcut yapılandırmasında, SOFA skorunun bileşenlerinin hesaplanması için gerekli olan bazı temel değişkenlerin MIMIC-IV verisetinde çok yüksek eksik veri oranlarına sahip olması büyük bir zafiyet oluşturmaktadır. Özellikle solunum fonksiyonunu değerlendiren SOFA bileşeni (sofa_resp), inspirasyon edilen oksijen fraksiyonu (FiO2) ve arteriyel kan gazı oksijen basıncı (PaO2) gibi parametrelere ihtiyaç duyar. Mevcut EDA çıktıları ve eksik veri analizleri, bu değişkenlerin %80 veya daha fazlası kadar eksik olabileceğini göstermektedir [[1]]. Benzer şekilde, karaciğer fonksiyonunu yansıtan sofa_liver bileşeni, serum bilirubin gibi laboratuvar değerlerine bağlıdır ve bu değerler de yüksek miktarda eksik olabilmektedir. Bu durum, SOFA skorunun doğruluğunu ve tutarlılığını ciddi şekilde zedelemektedir. Bir RL ajanının, solunum veya karaciğer fonksiyonu hakkında yanlış veya eksik bilgiye dayanarak mekanik ventilasyon ayarları veya ilaç dozajları gibi kritik kararlar alması kaçınılmaz olacaktır. Böbrek fonksiyonu (sofa_renal) bileşeni ise genellikle serum kreatinin ve üre nitratı gibi daha düzenli olarak ölçülen değişkenlerle hesaplandığından, daha düşük eksik veri oranlarıyla mevcuttur [[32]].

| SOFA Skoru Bileşeni | Temel Değişkenler | Tipik Eksik Veri Oranı (MIMIC-IV'de Tahmini) |
| :--- | :--- | :--- |
| Solunum (sofa_resp) | PaO2, FiO2, Ventilasyon Modu, SpO2 | Çok Yüksek (>60%) |
| Karaciğer (sofa_liver) | Serum Bilirubin | Yüksek (40-60%) |
| Böbrek (sofa_renal) | Serum Kreatinin, Üre Nitratı | Düşük (<20%) |
| Koagülasyon (sofa_coag) | Trombosit Sayısı | Orta (20-40%) |
| Sinir Sistemi (sofa_neuro) | GCS Skoru | Orta (30-50%) |

Tablodan da görüleceği üzere, SOFA skorunun en kritik bileşenlerinden olan solunum ve karaciğer fonksiyonlarının doğru bir şekilde temsil edilmesi, mevcut veri setindeki eksiklikler nedeniyle büyük bir zorlukla karşı karşıyadır. Bu zafiyeti aşmanın birkaç yolu vardır. İlk olarak, FiO2 ve PaO2 gibi kritik ama yüksek eksikliğe sahip değişkenler için imputasyon stratejileri iyileştirilmelidir. İkinci olarak, bu değişkenler yerine, daha sık ve güvenilir ölçümlere sahip olan mekanik ventilasyon statusu (var/yok), kan oksijen saturasyonu (SpO2), O2 akış hızı ve pozitif ekspiratuvar son basıncı gibi parametreler state vektörüne eklenerek solunum disfonksiyonu hakkında daha sağlam bir tahmin yapılabilir. Bu tür ikili (binary) veya süreklı özellikler, ajanın solunum desteği gerektiren hastaları anlamasına yardımcı olacaktır [[31]]. Benzer şekilde, sinir sistemi (GCS skoru) ve koagülasyon (trombosit sayısı) fonksiyonu için de benzer bir değerlendirme yapılmalıdır.

Diğer bir kritik alana laktat değeri ve onun zaman serisi analizi girer. Laktat, hem sepsis tanısı (septik şok için serum laktat > 2 mmol/L) [[29,39]] hem de tedavi yanıtı (laktat temizliği) [[27,43]] için hayati bir biyomarker'dır. Projede mutlak laktat değeri bulunmalıdır, ancak daha da önemlisi, laktat trendi ve tedavi başarısı hakkında bilgi veren bir metrik eklenmelidir. Laktat temizliği, `(ilk_laktat - gecikmeli_laktat) / ilk_laktat * 100` formülüyle hesaplanır [[39]]. Bu metrik, laktat düzeyinin düşüşünü tek bir sayısal göstergedeki yansıtma potansiyeli taşımaktadır ve bir tedavi stratejisinin etkinliğini değerlendirmede oldukça güçlüdür. Mevcut durum uzayına sadece mutlak laktat değeri eklenmek yerine, laktat temizliği gibi daha anlamlı bir türevsel özelliğin dahil edilmesi, ajanın tedavi protokollerini öğrenmesini ve optimize etmesini önemli ölçüde güçlendirecektir. Laktat eğilimlerinin sepsis alt tiplerini belirlemede de başarıyla kullanıldığına dair çalışmalar bulunmaktadır [[12,13]], bu da laktat dinamiğinin model için ne kadar değerli olabileceğini göstermektedir.

Son olarak, durum uzayının oluşturulmasında dikkate alınması gereken bir diğer unsur, ajanın aldığı eylemlerin takip edilmesidir. Proje özetinde, ajanın vazopressör dozajı ve sıvı tedavisi gibi eylemleri öğrendiği belirtilmektedir [[16]]. Ancak, bu eylemlerin neden ve ne zaman alındığı, yani tedavi protokollerinin takip edilmesi, durum uzayının bir parçası olarak modellenmemiş görünmektedir. Özellikle antibiyotik başlangıç zamanı ve mekanik ventilasyon başlatma zamanı gibi olaylar, sepsis yönetiminin ilk saatları için hayati önem taşır. Her bir saat geçtikçe, antibiyotik verilmiş mi? Hastanın ventilatörü var mı? Sorularının cevabı, hasta durumunun dinamiğini anlamak için kritiktir. Her bir saat geçtikçe, antibiyotik verilmiş mi? Hastanın ventilatörü var mı? Sorularının cevabı, hasta durumunun dinamiğini anlamak için kritiktir. Bu bilgiler, MIMIC-IV veri tablolarından (prescriptions, procedureevents) çıkarılabilir ve her bir zaman adımında birer bit (bit) veya tedavi sonrası geçen süre (elapsed time since event) olarak durum vektörüne eklenebilir. Bu tür "olay" (event) bazlı özellikleri eklemek, ajanın tedavi protokollerini (örneğin, antibiotik sonrası laktat düzeylerindeki değişim) öğrenmesine olanak tanıyacaktır. Örneğin, bir ajanın, aynı anda hem antibiyotik vermiş hem de vazopressör dozunu artırması gerektiğinde, bu iki eylemin kronolojik sırası ve birbirini izleme süresi, ajanın doğru stratejiyi seçmesinde önemli bir ipucu olacaktır. Bu nedenle, state vektörüne "antibiyotik_verildi_mi" ve "ventilasyon_başlatıldı_mi" gibi ikili değişkenlerin yanı sıra, bu olayların gerçekleştiği saatin bir önceki tetikleyiciye göre farkını gösteren "saat_sonra_antibiyotik" ve "saat_sonra_ventilasyon" gibi sürekli değişkenlerin de eklenmesi önerilmektedir. Bu yaklaşım, ajanın sadece mevcut vital işaretleri değil, aynı zamanda geçmişteki tedavi kararlarını da içeren daha zengin bir geçmiş temsiline sahip olmasını sağlayacaktır.

## Türevsel Özellikler ve Zenginleştirme Stratejileri

Mevcut veri setinin temel özelliklerini (temel değişkenleri) doğru bir şekilde temsil etmek, başarılı bir derin pekiştirmeli öğrenme (DRL) modeli için yeterli değildir. RL ajanının, hastanın dinamik durumu hakkında daha derinlemesine bir anlayış geliştirmesine ve karmaşık ilişkileri tespit etmesine yardımcı olmak için, mevcut verilerden türetilmiş (türetilmiş özellikler) veya zenginleştirilmiş yeni özelliklerin (feature engineering) modele eklenmesi kritik bir adımdır. Keşifsel Veri Analizi (EDA) çıktıları, değişkenlerin dağılımları, korelasyonları ve eksik veri oranları hakkında önemli ipuçları sunmaktadır. Bu bilgiler, RL ajanının durum uzayını (state space) zenginleştiren yeni özelliklerin tasarımı için yol gösterici olabilir. Bu bölüm, proje için potansiyel türevsel özellikler ve bu özelliklerin model performansını artırma potansiyellerini detaylı olarak incelemektedir.

Tıbbi karar verme süreçleri, sadece bir değişkenin mutlak değerine değil, aynı zamanda bu değerlerin zaman içindeki değişimine (fark/değişim) ve eğilimlerine de dayanır [[15]]. Vücut ısısının ani yükselişi, kan basıncının düşmesi, kalp atış hızının artış göstermesi veya kan pH değerinin düşmesi gibi trendler, organ disfonksiyonunun gelişimini veya şiddetlenmesini erken阶段'te gösterebilir. Projenin EDA not defteri, değişkenlerin zaman serisi grafiklerini içerdiğinden, bu tür dinamik eğilimleri nicel olarak ifade eden yeni özellikler türetmek mümkündür. `pipeline.py` dosyasındaki saatlik gruplama mantığını kullanarak, her numerik değişkenin önceki saatteki değerden farkını hesaplayan delta (Δ) özellikler oluşturulabilir. Örneğin, `delta_sistolik_basinc`, `delta_kalp_atis_hizi`, `delta_ph`, `delta_laktat` gibi özellikler, ajanın hastanın durumundaki aniden kötüleşmeleri (deterioration) daha hızlı tespit etmesine ve müdahale etmesine yardımcı olacaktır. Bu delta özellikler, ajanın yalnızca "ne" olduğunu değil, aynı zamanda "nasıl değiştiğini" de anlamasına olanak tanır. Bu, özellikle sepsis gibi hızla ilerleyen bir durumda, ajanın reaktif değil, proaktif bir karar vericisi haline gelmesini sağlayabilir.

Özelliklerin normalizasyonu ve standardizasyonu, özellikle de MIMIC-IV gibi çeşitli değişken tiplerini ve ölçeklerini içeren bir veri seti için de son derece önemlidir. Kan basıncı gibi değişkenler 70-150 mmHg arasında, lökosit sayısında ise 3-20 x 10^9/L arasında değişirken, serum kreatinin gibi başka bir değişken milimol/L cinsinden ölçülür. Bu farklı ölçekler, derin öğrenme ağlarının eğitimini zorlaştırabilir çünkü yüksek değerli özellikler, düşük değerli özelliklere göre daha baskın bir rol oynar. Bu nedenle, tüm özelliklerin aynı ölçek aralığına getirilmesi veya standart sapmalarına bölünmesi tavsiye edilir. Ortalama ve standart sapma kullanılarak yapılan z-skoru dönüşümü, özellikle normal dağılıma yakın değişkenler için etkilidir. Eğer bir değişken çarpık bir dağılıma (skewed distribution) sahipse, logaritmik dönüşüm (`log(x + 1)`) gibi teknikler uygulanarak daha simetrik bir dağılıma yaklaştırılabilir. `pipeline.py` dosyasının, bu normalleştirme/standardizasyon adımlarını içermesi beklenir. Ancak, hangi yöntemin hangi değişken için uygulanacağına karar vermek önemlidir. Örneğin, laktat gibi çarpık dağılıma sahip değişkenler için log transformasyonu, modelin bu değişkeni daha iyi anlamasına yardımcı olabilir. Benzer şekilde, ağırlık bazlı dozajlar (örneğin, vazopressör dozu mg/kg/saat) gibi özellikler, hastanın ideal vücut ağırlığına göre normalize edilerek daha makul bir durum temsili sağlanması önerilebilir. Bu, farklı boyutlardaki hastalar arasındaki dozaj kararlarını daha adil kılar.

Projenin mevcut durum uzayı, sadece laboratuvar ve vital işaretlerine odaklanmakta olabilir. Ancak, demografik bilgiler ve genel hasta risk profilleri gibi ek bilgiler, durum uzayını önemli ölçüde zenginleştirebilir. Yaş, sepsis için en güçlü prediktif faktörlerden biridir; yaş ilerledikçe organ rezervi azalır ve enfeksiyona karşı direnci düşer [[33]]. Bu nedenle, yaş doğrudan bir özellik olarak state vektörüne eklenebilir. Cinsiyet gibi demografik bilgiler de bazı sepsis alt tipleri ve yanıt üzerinde farklı etkilere sahip olabileceğinden, modele dahil edilmeleri faydalı olabilir. Ayrıca, APACHE II (Acute Physiology and Chronic Health Evaluation II) gibi genel hasta risk skorları, hastanın genel sağlık durumunu ve önceden var olan komorbilite (comorbidity) durumlarını özetleyerek valuable bir bakış açısı sunabilir. Bu skorlar, MIMIC-IV verisetinde bulunabilir ve ajanın karar verme sürecine bir "risk kontekst" ekleyebilir. Örneğin, aynı vital işaretleri paylaşan iki hastadan, daha yüksek APACHE II skoruna sahip olanın daha hassas bir müdahaleye ihtiyaç duyabileceği varsayılabilir.

Son olarak, dışsal tıbbi bilgi ve uluslararası kılavuzlar, RL ajanına insan doktorların sahip olduğu "hekimlik bilgisi" (clinical knowledge) kazandırabilir. Surviving Sepsis Campaign (SSC) gibi kuruluşlar, sepsis ve septik şok yönetimi için evrensel olarak kabul görmüş kılavuzlar yayınlamaktadır [[29,37]]. Bu kılavuzlar, özellikle septik şok vakalarında mean arterial pressure (MAP) için 65 mmHg'nin hedeflenmesini tavsiye etmektedir [[29]]. Bu hedef, RL ajanının vazopressör dozajını ayarlarken referans noktası olarak kullanılabilir. Örneğin, ajanın aldığı eylem (vasopressör dozu) ve ulaştığı yeni durum (yeni MAP) arasındaki farkı, bu hedefe yaklaşma (convergence to target) metriğiyle değerlendirebiliriz. Benzer şekilde, SSC kılavuzları, hidrasyon için ilk 3 saatte en az 30 mL/kg crystalloid verilmesini önermektedir [[29]]. Bu bilgi, ajanın sıvı resusitasyon stratejisini şekillendirmesine yardımcı olabilir. Bu tür dışsal bilgiler, modelin yalnızca verideki pasif ilişkilere dayanarak değil, aynı zamanda tıbbi literatürdeki aktif önerilere de uygun olarak hareket etmesini sağlayarak, geliştirdiği politikanın klinik olarak daha güvenilir ve geçerli olmasını sağlayacaktır.

## İstatistiksel Sağlamlık ve İmputasyon Stratejileri: Riskler ve Alternatif Yaklaşımlar

Veri setindeki eksik gözlemlerin (eksik verilerin) doğru bir şekilde ele alınması, herhangi bir tıbbi makine öğrenmesi projesinde en kritik ve tartışmalı aşamalardan biridir. Eksik veriler, modelin eğitimi sırasında yanlı (sapmalı) sonuçlar üretmesine, tahmin yeteneğinin düşmesine ve genelleme performansının kötüleşmesine neden olabilir. Projenin mevcut ön işleme hattında uygulanan imputasyon (eksik değer doldurma) stratejisi, sağlanan `pipeline.py` dosyasına ve EDA sonuçlarına dayanarak "forward-fill" (FFILL) olarak belirlenmiştir. Bu yöntem, bir değişkenin bir saatte eksik kaldığı durumlarda, o değişkenin son ölçülen değerini (Last Observation Carried Forward - LOCF) tekrar kullanmayı hedefler [[4]]. Ancak, bu basit stratejinin, özellikle MIMIC-IV gibi tıbbi zaman serisi verilerindeki yüksek oranda eksikliğe sahip değişkenler için ciddi istatistiksel ve tıbbi sınırlılıkları bulunmaktadır. Bu bölümde, FFILL yöntemine yönelik riskler detaylandırılarak, literatürdeki daha sağlam alternatif imputasyon yaklaşımları tartışılmakta ve projenin istatistiksel sağlamlığını artıracak stratejik öneriler sunulmaktadır.

Forward-fill (LOCF) yönteminin temel sorunu, eksik verilerin neden oluştuğunu (missingness mechanism) göz ardı etmesidir. Tıbbi zaman serilerinde, bir laboratuvar testinin veya vital işaretin eksik olması her zaman rastgele olmayabilir. Örneğin, eğer bir hasta kritik bir şekilde kötüleşirse, tıbbi personel sabit aralıklarla değil, daha sık olarak müdahalede bulunur ve dolayısıyla bazı ölçümler atlanabilir. Bu durum, "eksiklik gözlemlenebilir" (Missing Not At Random - MNAR) olarak adlandırılır. LOCF yöntemi, eksikliğin bilgi taşımama (informative missingness) potansiyelini görmezden gelir. En kötü senaryoda, LOCF, hastanın durumunun stabil kaldığına dair yanlış bir izlenim yaratır. Özellikle %80'in üzerinde eksikliğe sahip temp_c (vücut ısısı) gibi değişkenler için FFILL, ajanın bu 6 saat boyunca yüksek laktat seviyesi altında kaldığına dair yanlış bir izlenim verecektir [[8]]. Literatür, LOCF yöntemini, özellikle MAR (Missing At Random) ve MCAR (Missing Completely At Random) mekanizmaları altında, en az sapmalı ve en kötü kaplama olasılığına sahip imputasyon teknikleri arasında göstermektedir [[22,42]]. Bu nedenle, projenin temelini oluşturan imputasyon stratejisi, gelecekteki sonuçların güvenilirliği açısından gözden geçirilmelidir.

Bu sınırlılıklara çözüm arayışında, literatürde çok daha güvenilir ve sofistike imputasyon yöntemleri önerilmektedir. Bunlardan en önemlisi **Çoklu İmputasyon** (Multiple Imputation - MI) olarak kabul edilir [[25]]. MI, eksik bir değeri tek bir değerle doldurmak yerine, eksikliğin kendisinden kaynaklanan belirsizliği (uncertainty) nicel olarak ifade etmek için geliştirilmiş bir paradigmadır. Yöntem, eksik değerleri doldurmak için birden fazla (genellikle 5 ila 10 arasında) farklı tamamlanmış veri seti oluşturur [[23]]. Her bir tamamlanmış set ayrı ayrı analiz veya model eğitimi için kullanılır ve sonuçlar sonunda birleştirilir. Bu, imputasyon sırasında kaybedilen bilgiyi (uncertainty) modelinize dahil etmenizi sağlar ve daha güvenilir ve genelleşebilir sonuçlar üretir [[5]]. MICE (Multivariate Imputation by Chained Equations) gibi teknikler, verideki farklı değişken tipleri (sayısal, kategorik) için uygun regresyon modelleri (örneğin, lojistik regresyon, çoğul regresyon) kullanarak çalışır ve her bir değişkenin eksik değerlerini diğer değişkenlerin bilinen değerlerine dayalı olarak doldurur [[3]]. Projenin ön işleme hattına MI/MICE entegre edilmesi, imputasyon kalitesini önemli ölçüde artırabilir.

Model bazlı imputasyon teknikleri de giderek daha popüler hale gelmektedir. Son yıllarda, derin öğrenme modelleri, tıbbi zaman serileri için eksik verileri impute etmek üzere kullanılmaktadır. Özellikle Generative Adversarial Networks (GAN'lar) gibi modeller, tıbbi zaman serileri için eksik verileri impute etmek üzere kullanılmaktadır. ccGAN (clinical conditional GAN), hastanın diğer zaman serisi verilerine koşullu olarak gerçekçi ve tutarlı eksik veriler üretebilir [[10,11]]. Bu, FFILL gibi basit yöntemlere kıyasla daha doğal ve tutarlı veri yapısı oluşturabilir. Benzer şekilde, Fourier ve k-nearest neighbor (k-NN) kombinasyonu gibi hibrit imputasyon teknikleri de biyomedikal zaman serilerinde yüksek doğruluk elde etmiştir [[28]]. Bu yöntemler, hem zaman serisinin frekans domain özelliklerini hem de benzer örnekler arasındaki benzerlikleri kullanarak daha akıllıca imputasyonlar yapar. Projenin ileri safhalarında, bu model bazlı imputasyon tekniklerini keşfetmek ve uygulamak, veri kalitesini ve dolayısıyla RL ajanının performansını önemli ölçüde artırabilir.

Projede belirtilen yüksek eksik veri oranlarına sahip değişkenler için, imputasyon dışında bir strateji de düşünülebilir: **ikili koşullu dahil etme**. Bazı değişkenler, özellikle nadir hastalıklar veya nadir olarak ölçülen testler için çok yüksek eksiklik gösterebilir. Eğer bir değişken klinik olarak kritikse, onu state'e hiç dahil etmek yerine, "değer gözlemlendi mi?" şeklinde bir ikili (binary) özellik eklemek daha sağlıklı olabilir. Örneğin, laktat değeri yoksa, `lactate_observed = 0` olur; varsa `lactate_observed = 1` olur ve laktat değeri `lactate_value` özelliği ile birlikte kullanılır. Bu yaklaşım, eksikliğin bilgi taşıma potansiyelini (informative missingness) modelinize dahil etmenizi sağlar. Eğer laktat değeri hiçbir zaman ölçülmüyorsa, bu durum kendisi bile önemli bir bilgidir. Bu ikili feature, ajanın durum uzayını genişletir ve eksik veri problemini daha bilinçli bir şekilde ele almasını sağlar.

Son olarak, `pipeline.py` gibi bir betik, bu farklı imputasyon stratejilerini destekleyecek şekilde esnek bir yapıya sahip olmalıdır. Tüm değişkenlere aynı imputasyon yöntemini uygulamak genellikle optimal değildir. EDA çıktısı, hangi değişkenlerin ne kadar eksik olduğunu göstermektedir. Bu bilgi, değişkenlere özgü farklı imputasyon stratejileri belirlemek için kullanılmalıdır. Örneğin:
*   **Düşük eksiklik oranına (örneğin <10%) sahip vital işaretler:** Saatlik ortalamalar veya medyanlar kullanılarak imputasyon yapılabilir.
*   **Orta eksiklik oranına (örneğin 10-40%) sahip laboratuvar değerleri:** Çoklu imputasyon (MICE) gibi regresyon tabanlı yöntemler tercih edilebilir.
*   **Yüksek eksiklik oranına (örneğin >40%) sahip değişkenler:** Eğer klinik olarak hayati değilse, state'e dahil edilmeyebilir. Eğer hayatsa, imputasyon yerine ikili "değer gözlemlendi mi?" özelliği eklenmelidir veya model bazlı imputasyon teknikleri denenmelidir.

Bu stratejik yaklaşım, projenin sadece teknik olarak sağlam bir yapıya kavuşmasını değil, aynı zamanda geliştirilen RL ajanının gerçek klinik ortamda güvenilir ve faydalı bir karar destek aracı olma potansiyelini de maksimize edecektir.
